---
layout: post
title:  "가상화 (인프라 가상화를 중심으로)"
date:   2016-10-13 17:31:45 +0900
published: false

categories: diary
---

한 5년 전 쯤인가, 그때 처음 "가상화" 라는 단어에 관심을 갖게 됐다.
그 계기가 참 현실적 이었는데, 집에서 가지고 놀던 컴퓨터를 한 3대쯤 돌리다보니
그 달 전기세가 10만원 가까이 나온것.

장난감을 끌수도 없고, 전기세는 무섭고. 그래서 찾다보니 생각한게 **가상화**
였는데, 하나의 물리 장비에 논리 장비로 구분해서 사용할 수 있다는 개념은 대단히 충격이었다.

당시에는 리눅스고 뭐고 아는게 하나도 없던 때라(물론 지금도 잘 모른다, 큰일이네)
주먹구구식으로 VMware 부터 깔아보기 시작해서, 가상화에 대한 관심으로 결국 학교 인턴쉽 프로그램으로
xen 을 이용하여 제품개발하는 회사에도 지원해서 가게 되었다.
굳이 따지자면, 여기가 나의 커리어의 시작이라고 생각한다.
(아이오차드의 김희철 사장님께 감사의 인사를..)

선두의 썰이 좀 길었는데, 당시에는 **가상화** 가 워낙 핫한 키워드였다.
이듬해엔 **클라우드** 라는 그야말로 뜬구름잡는 단어가 출현하더니,
사람들은 혼란스러워 하고 **클라우딩** 이라는 정체모를 단어도 막 돌아다니고 그랬다.
마케팅 용어의 무서움을 몰랐다.

가상화는 인프라부터 시작해서 기존 시장을 뒤흔들 기세였다.
벤더는 장비 판매가 부진해 질 것이고, 자동화된 인프라 관리로 인해 SE 의 역할은
점점 줄어들 것이라는 불안한 미래가 감지되었다.
그러나 어쩌랴, 이미 시대는 바뀌고 있는것을.
따라가지 못하면 정말 어쩔수 없는 상황이 되었다.

### *가상화* 라는 단어

*가상화* 라는 단어는 내게는 "VMware" 의 대명사 같은 느낌이었다.
가상화 라는 단어에 대해서 고민하게 된 때는,
이후에도 숱하게 쏟아지는 *가상화*라는 키워드 때문이었다.

인프라 가상화, 네트워크 가상화, 스토리지 가상화... 오만군데에 가상화가
붙어나왔다. 나만 몰랐을 뿐이지, 사실 **가상** 이라는 단어는 오래전부터 사용되고
있었다. 예를들어 *가상 현실*,  *가상 메모리*, *가상 함수*, *가상 머신*이 그렇다.
이미 사용하고 있었음에도, 어째서 *가상* 이라는 단어가 쓰이는지 생각해보지 않았다. 

생전 처음 보는 개념을 접근하는 습관은, 단어에 대한 분석이었다. 그 이름은 그냥
붙었을리 없다. 이 단어가 포함하고 있는 개념을 최대한 설명하기 위해, 내부에서
수많은 각축을 벌이고 살아남은 생명력 강한 단어일 것이다. 

### [*가상*](https://en.oxforddictionaries.com/definition/virtual) 이라는 단어

> virtual (adj.)
> : 2. Computing<br>
> Not physically existing as such but made by software to appear to do so.

> 가상
> :假想 [가:-]<br>
> 사실이 아니거나 존재하지 않는 것을 사실이거나 실제로 있는 것처럼 가정하여 생각함

**실제하지 않지만, 소프트웨어에 의해서 그렇게 보이도록 만들어진 것** 이라고
정의되어 있다. 따라서, *가상* 이라는 단어가 붙은 것들은, *실제하지 않는것을
실제하는 것처럼 만들어주는 무엇* 이라고 생각해도 무방할 것이다.

조금 거칠게 말하자면, **뻥을 친다** 라고 말할 수 있다. 
그리고 이 개념을 설명할때 이 표현을 쓰는것을 아주 좋아한다. :^)

### 다시, *가상화* 라는 단어

*가상* 이라는 영어단어는 *Virtual*(adj.) 이다.
*가상화* 는 *가상* 이라는 명사에 *-화* 접미사가 붙어, 
*'그렇게 만들거나 됨'의 뜻을 더한다.* 즉, *가상화* 는 *사실이 아니거나 존재하지
않는것을 소프트웨어에 의해 그렇게 보이도록 만듦* 이라고 생각할 수 있다.
이 *가상화* 는  *Virtualizaion* 가 번역된 단어이며, 짧게 *V12n* 이라고 한다.[^v12n]

이를 염두하여 *infrastructure virtualization* 를 살펴보면, *소프트웨어가 동작하기 위해 필요한
기반시설(짧게 **인프라**)을 가상화* 하였다고 생각할 수 있다.
실제로는 없는 인프라를 가상화 하여, 마치 있는 것처럼 만들었다는 것이다.

*"인프라스트럭쳐를 가상화 하였다"* 라는 표현은  *인프라 가상화* 일까, *가상화 인프라* 일까?

이는 마치 *고래상어는 고래인가 상어인가* 하는 말처럼 말장난처럼 보일 지 모르지만,
고래상어가 고래인지 상어인지 구별하는 문제 만큼이나 중요하게 느껴졌다.

근데 참고로 고래상어는 상어이다.

### 인프라(를) 가상화 vs 가상화(를) 인프라

통용되는 단어는 *인프라 가상화* 이다. 왼쪽부터 오른쪽으로 해석하는 한국어 어순에
맞게, *인프라(를) 가상화* 한다는 의미에서 인프라 가상화 라는 단어가 정착된 것
같다. "가상화(를) 인프라" 는 뭔가 어색하다.

그런데 어째서 "인프라를 가상화" 했어야 했을까? 사실 "인프라 가상화" 안에는
"서버 가상화", "네트워크 가상화", "스토리지 가상화" 같이 인프라의 하위 요소들도
포함되어 있다. 이것들을 가상화 해서 얻는 이점은 무엇일까?

### (최소한의) 기반 시설

소프트웨어를 하나 실행시키려고 해도, 수많은 요소가 필요하다.

* 전기가 들어와야 함
* 컴퓨터가 켜져야 함
  * CPU
  * Memory
  * Disk
  * Network
  * I/O peripherals...
* 운영체제가 설치되어야 함

아주 대충 말하자면 소프트웨어가 동작하기 위한 최소한의 환경이라고 생각할 수
있다. 말하자면, 소프트웨어를 지탱하고 있는 최소한의 기반이다.
그래서 이름이 infrastructure, 즉 **기반 시설**이다.

사회가 동작하기 위해 수도나 도로, 전기와 같은 기반시설이 필요한 것 처럼,
소프트웨어가 동작하기 위해서 마찬가지의 기반시설이 필요하다.
정식대로 표현하자면 infrastructure 같은 용어가 있지만, 보통은 "인프라"라고 한다.

### 인프라 = **서버** + 네트워크 + 스토리지

인프라를 구성하는 요소는 다양하고, 각 요소마다 전문분야가 따로 존재하지만, 아주
대충 나눠보자면 *인프라 = 서버 + 네트워크 + 스토리지* 라고 퉁칠 수 있다.

*아까부터 쓰는 용어가 겁내 대충대충이네?* 라고 불만가지실 분들도 있다는것을 잘
안다. 학문적으로 엄밀하게 정의된 용어가 아닌, 현장에서 투박하게 쓰이는 용어임을
감안해주시기를 바란다. 

이 중에서도, *인프라 담당자 입니다* 라고 하면 열의 아홉은 *서버 담당자* 라고 볼
수 있다. 네트워크 와 스토리지에 대한 기초적인 이해는 있지만, 이 영역들도 고도로
전문화되어 있고 심지어 그 안에서도 세분화 되기 때문에, 네트워크 엔지니어와
스토리지 엔지니어는 명확하게 따로 지칭하는 분위기가 있다.
(물론 네트워크 엔지니어와 스토리지 엔지니어도 서버에 대한 기초적인 이해가 있다)

이 인프라를 구축하고, 정비하는 역할을 수행하는 인원을 *시스템 엔지니어* 라고
하고, 이 인프라를 운영하는 인원을 *시스템 오퍼레이터* 라고 한다.

이 기반시설 위에 동작할 수 있는 프로그램을 만드는 사람들을 *소프트웨어 개발자*
라고 하며, 기반시설부터 소프트웨어까지 전체적인 구조를 설계하는 사람들을 *아키텍터* 라고
한다.

그리고 이들에게 월급주는 사람을 *사장님* 이라고 한다. (제일 중요하신 분)

### 딱딱한 인프라

즉, *소프트웨어를 돌리려면 기반시설들을 모두 갖춰야* 한다.
인프라를 갖추는 시간 + 소프트웨어를 배포하는 시간이 총 시간이라고 보자면,
인프라를 얼마나 빠르게 갖출 수 있느냐는 전체적인 시간을 줄이는 중요한 요인이 된다.

또 다른 인프라의 문제는, 유연하지가 않다는 점이다.
서버를 어딘가에 설치했다고 가정해보면, 이걸 어디에 뜯어서 옮기는게 쉽지
않다는걸 알 수 있다. 단순히 서버가 무거운걸 말하는것이 아니라, 전기 배선이라던가, 네트워크 회선
이라던가, 너무 덥지는 않은지, 근처에 물이 새거나 하지는 않는지, 사람이 쉽게
접근해서 조작할 우려가 있지는 않는지, 화재등 위험이 있지는 않는지 생각해볼게
많다. 게다가 운용환경에서 동작하는 서버라면? 전원 꺼지는건 상상할수도 없다.
즉, 한번 구축되면 뜯어서 옮기는게 거의 불가능하다고 봐야 한다.

*인프라*라는 것은 *뭐라도 하려면 꼭 있어야 하는 주제에, 비용도 엄청 들어가고,
구축하려면 시간은 더럽게 많이 걸리면서 한번 뿌리내리면 뽑아 옮기기도 쉽지않은* 존재라고 할 수 있다.
말하자면 **서울에서 집 구하는 문제와 비슷하다**

(빌어먹을)

인프라가 가지는 단점의 대부분의 원인은, 인프라가 딱딱하기 때문이다.
인프라가 딱딱한 이유는, 실제로 인프라는 딱딱하기 때문이다.
**뭔가 문제가 생겼을때 걷어찰 수 있는 부분을 하드웨어**라고 한다면,
전통적인 의미의 인프라는 순전 하드웨어로 구성된 딱딱한 물건이라고 볼 수 있는 것이다.

1. 전기 배선을 끌어오고,
2. 온습도가 유지되는 장소에, 
3. 서버를 사와서 설치하고,
4. 네트워크 케이블을 꼽고,
5. 운영체제를 설치하고

이 중에 하나라도 시간이 지연되면 한없이 느려진다.
그나마 1, 2 번은 서버를 보관해주는 서비스를 제공하는 업체가 있기
때문에 내가 머리아플 필요는 없지만,
서버를 사와서 설치하고 네트워크를 구성하는 일은 시간과 비용이 들어간다.

비용이 들어간다는 말은, 시간이 엄청나게 들어갈 수 있다는 말과 같다.
서버 신청서를 작성해서 결재를 맡고, 비용이 집행되기 까지는 회사의 프로세스에
맡길수밖에 없다.

이 기간을 단축하기 위해서 안쓰는 깡통서버를 땡겨오기도 하고, 난리를 친다.
가장 큰 문제는, 개발환경 구축이다. 하루 유지하는것만도 몇백몇천 드는 개발인력들을
모셔다 놓고, 개발 환경이 구축이 안돼서 손빨고 있는 경우가 허다했다.
그런다고 전체 일정이 미뤄지는것도 아니니, 개발자들은 마음이 급해질수밖에 없다.

인프라가 딱딱하지만 않아도 좋을텐데...

### 스푼이 없다고 생각하세요

상상해보자, 인프라를 수호하는 천사가 강림하여 복잡다단한 일들을 처리해준다고
생각해보자. 


### 서버 가상화의 역사

서버를 가상화 하려는 노력은 1960 년대부터 시작되었다고 한다.
그 당시에 이미  *수도나 전기처럼, 컴퓨팅 파워를 쓴 만큼 돈을 낸다*는 유틸리티
컴퓨팅의 개념이 이미 있었다. 그러나 당시의 기술로는 이를 구현할수가 없었다.

이후, IBM 의 System/370 에서 최초의 서버 가상화 기술이 도입되었다.[^system370]
기존에 잘게 나눠져 있던 머신들을 하나의 메인프레임에 통합 관리하려는 최초의
시도가 되었다.

[^v12n]: Virtualization 을 V12n 으로 줄여쓰는 이유는, V와 n 사이에 12글자가 있기 때문이다. 비슷한 예로 국제화(Internationalization) 는 `I18n` 으로 표현한다.
[^system370]: [IBM VM/CMS](https://en.wikipedia.org/wiki/VM_(operating_system))
